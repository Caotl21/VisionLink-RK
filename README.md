# AUV-StreamCore

**AUV-StreamCore** æ˜¯ä¸€ä¸ªä¸“ä¸º **Rockchip RK3588** å¹³å°ï¼ˆå¦‚ Orange Pi 5 Proï¼‰è®¾è®¡çš„é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿè§†é¢‘æ¨æµå¼•æ“ã€‚

è¯¥é¡¹ç›®å……åˆ†åˆ©ç”¨äº† Rockchip çš„ç¡¬ä»¶åŠ é€Ÿèƒ½åŠ›ï¼Œå®ç°äº†ä»æ‘„åƒå¤´é‡‡é›†ã€è‰²å½©ç©ºé—´è½¬æ¢ã€H.264 ç¼–ç åˆ°ç½‘ç»œä¼ è¾“çš„å…¨é“¾è·¯ä¼˜åŒ–ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

*   **V4L2 é‡‡é›†**ï¼šç›´æ¥æ“ä½œåº•å±‚ Video4Linux2 æ¥å£ï¼Œè·å–åŸå§‹ YUYV å›¾åƒæ•°æ®ã€‚
*   **ç¡¬ä»¶åŠ é€Ÿè½¬æ¢ (RGA)**ï¼šä½¿ç”¨ Rockchip **RGA (2D Graphic Acceleration)** è¿›è¡Œæ ¼å¼è½¬æ¢ï¼ˆYUYV -> NV12ï¼‰å’Œç¼©æ”¾ã€‚
    *   *äº®ç‚¹ï¼šä½¿ç”¨ DMA Buffer å®ç°é›¶æ‹·è´ (Zero-Copy)ï¼Œä¸å ç”¨ CPUã€‚*
*   **ç¡¬ä»¶ç¼–ç  (MPP)**ï¼šé›†æˆ Rockchip **MPP (Media Process Platform)**ï¼Œå®ç° H.264 ç¡¬ä»¶ç¼–ç ã€‚
    *   *äº®ç‚¹ï¼šæ”¯æŒ CBR (å›ºå®šç ç‡) æ§åˆ¶ï¼Œç›´æ¥è¾“å…¥ DMA FDï¼Œæå¤§é™ä½å»¶è¿Ÿã€‚*
*   **UDP ä½å»¶è¿Ÿä¼ è¾“**ï¼šé€šè¿‡åŸå§‹ UDP Socket å‘é€ H.264 ç æµï¼Œæå¤§å‡å°‘ä¼ è¾“å¼€é”€ã€‚

## ğŸ› ï¸ ç¡¬ä»¶ä¸ç¯å¢ƒè¦æ±‚

*   **ç¡¬ä»¶å¹³å°**ï¼šOrange Pi 5 / 5 Pro / 5 Plus (åŸºäº RK3588/RK3588S)
*   **æ“ä½œç³»ç»Ÿ**ï¼šUbuntu 20.04 / 22.04 (Rockchip BSP)
*   **ä¾èµ–åº“**ï¼š
    *   `libv4l-dev`
    *   `librga-dev` (Rockchip RGA)
    *   `librockchip-mpp-dev` (Rockchip MPP)
    *   `opencv` (å¯é€‰ï¼Œç›®å‰ä»…ç”¨äºè¾…åŠ©)

## ğŸ“‚ é¡¹ç›®ç»“æ„

```text
.
â”œâ”€â”€ CMakeLists.txt      # æ„å»ºè„šæœ¬
â”œâ”€â”€ inc/                # å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ dma_utils.h     # DMA Buffer ç®¡ç†
â”‚   â”œâ”€â”€ mpp_encoder.h   # MPP ç¼–ç å°è£…ç±»
â”‚   â””â”€â”€ v4l2_utils.h    # V4L2 æ“ä½œå°è£…
â”œâ”€â”€ src/                # æºä»£ç 
â”‚   â”œâ”€â”€ dma_utils.cpp   # å®ç° dma-heap å†…å­˜åˆ†é…
â”‚   â”œâ”€â”€ main.cpp        # ä¸»ç¨‹åºå…¥å£ (é‡‡é›†->RGA->MPP->UDP)
â”‚   â”œâ”€â”€ mpp_encoder.cpp # MPP ç¼–ç å®ç°
â”‚   â””â”€â”€ v4l2_utils.c    # V4L2 é‡‡é›†å®ç°
â””â”€â”€ README.md           # è¯´æ˜æ–‡æ¡£
```

## âš™ï¸ ç¼–è¯‘ä¸æ„å»º

ç¡®ä¿ä½ çš„ç³»ç»Ÿç¯å¢ƒå·²å®‰è£…å¿…è¦çš„å¼€å‘åº“ã€‚

```code
# 1. åˆ›å»ºæ„å»ºç›®å½•
mkdir build
cd build

# 2. ç”Ÿæˆ Makefile
cmake ..

# 3. ç¼–è¯‘
make -j4
```

## ğŸš€ è¿è¡ŒæŒ‡å—